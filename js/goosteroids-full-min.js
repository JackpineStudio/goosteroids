/* 
 * Constants
 */function It(){var e=new Dr(ut.width/2,ut.height/2);ct=new rr(e,H,F,B,j),ct.orientation=-r/2}function qt(){if(!ct.alive&&ot>0){ot--;var t=Math.ceil(ot/e);t>0&&Cn(ut,ft,t)}else!ct.alive&&ot==0&&It()}function Rt(){ft.clearRect(0,0,ut.width,ut.height),ht.length==0&&(pt=[],Kt()),Qn(ht),vn(pt),er(ht,u,d,!0),ir(ct,I),$n(dt),Gn(ft,lt,ht),sr(ft,ct,I,U,z,W);if(ct.accelerating&&!ct.abActivated){var e=ar(q,I,nt,tt);or(ft,ct,e,null,Y,Z)}if(ct.accelerating&&ct.abActivated&&ct.abFuel>0){var e=ar(q,I,it,rt);or(ft,ct,e,null,Y,Z)}mn(ft,pt),Jn(ft,dt),Nn(ut,ft,ct.abFuel),xn(ut,ft,Tt),Tn(ut,ft,Ct),Sn(ut,ft,Nt);if(Ct<0){Qt();return}qt()}function Ut(){Lt=setInterval(Rt,1e3/e)}function zt(){clearInterval(Lt)}function Wt(){un(kt),kt=0}function Xt(){At=setInterval(Wt,Ot)}function Vt(){clearInterval(At)}function $t(){$("#introduction").fadeOut(2e3),$("#instructions").fadeIn(2e3)}function Jt(){Sr(),ft.clearRect(0,0,ut.width,ut.height),xt="",Nt=0,Tt=1,Ct=3,kt=0,ht=[],pt=[],dt=[],It(),$("#instructions").stop(),$("#stageMessage").html("Stage "+Tt),$("#instructions:visible").fadeOut(2e3),$("#stage").fadeIn(2e3,function(){setTimeout(function(){$("#game").show(),$("#stage").fadeOut(2e3,function(){sn(function(e){_t=e.game_id,on(function(){Ln(),Ut(),Xt()})})})},500)})}function Kt(){Vt(),zt(),un(kt,function(){an(function(){$("#stageMessage").html("Stage "+Tt),$("#stage").fadeIn(2e3,function(){setTimeout(function(){$("#stage").fadeOut(2e3),$("#game").fadeIn(2e3),on(function(){It(),Ut(),Xt()})},500)})})}),kt=0}function Qt(){br(),An(),Vt(),zt(),un(kt,function(){fn(function(e){$("#gameOver").show(),$("#game").fadeOut(2e3,function(){e.high_score?bn(Gt):Gt()})})}),kt=0}function Gt(){cn(function(e){var t=e.high_scores;$("#score").text(Nt),$("table.highScores tr:not(.table-header)").remove();for(var n=0;n<t.length;n++){var r="<tr>";r+="<td>"+t[n].player_name+"</td>",r+="<td>"+t[n].stage+"</td>",r+="<td>"+t[n].score+"</td>",r+="<td>"+t[n].time+"</td>",r+="</tr>",$("table.highScores").append(r)}$("#highScores").show(),$("#gameOver").fadeOut(2e3)})}function Yt(e){if(Dt&&!Pt){setTimeout(function(){Yt(e)},1e3);return}ut=document.getElementById("canvas"),ft=ut.getContext("2d"),at=document.createElement("canvas"),at.width=ut.width,at.height=ut.height,lt=at.getContext("2d"),I=ur(q,R),It(),$("body").focus(),$("body").keydown(function(e){Dn(e)}),$("body").keyup(function(e){Pn(e)}),Mn(new On(gt,Hn)),_n(new On(gt,Bn)),Mn(new On(bt,jn)),_n(new On(bt,Fn)),Mn(new On(wt,In)),_n(new On(wt,qn)),Mn(new On(Et,Rn)),_n(new On(Et,Un)),Mn(new On(St,zn)),_n(new On(St,Wn)),e.call(this)}function en(e){return e.type.valueOf()=="error"}function tn(e){if(e.type.valueOf()=="error"){Vt(),zt();var t=e.error_message;Ft&&console.log("Error: "+t),yn()}}function nn(e,t){Vt(),zt();var n="Ajax failure: "+e+" ("+t+")";Ft&&console.log(n),yn(n)}function rn(e,t,n){t.session_id=Mt,Ft&&console.log("ajax request: "+e+", data: "+Or(t));var r=$.ajax({url:e,type:"POST",timeout:2e3,dataType:"json",cache:!1,data:t});r.done(function(t,r,i){Ft&&console.log("ajax response: "+e+", status: "+r+", data: "+Or(t)),en(t)?tn(t):n&&n.call(this,t)}),r.fail(function(t,n,r){Ft&&console.log("ajax response: "+e+", status: "+n+", error: "+r),nn(n,r)})}function sn(e){rn("goosteroids/new_game.json",{},e)}function on(e){var t={game_id:_t};rn("goosteroids/get_settings.json",t,function(t){s=t.settings.gravity,o=t.settings.gravity_dropoff,u=t.settings.glob_max_speed,f=t.settings.glob_blast_radius,l=t.settings.glob_blast_magnitude,h=t.settings.glob_cr,pn(t.settings.blobs),e&&e.call(this,t)})}function un(e,t){if(!Zt){Zt=!0;var n={game_id:_t,lives:Ct,globs_destroyed:e};rn("goosteroids/update_game.json",n,function(e){Zt=!1,t&&t.call(this,e)})}else setTimeout(function(){un(t)},1e3)}function an(e){var t={game_id:_t};rn("goosteroids/end_stage.json",t,function(t){Tt++,kt=0,e&&e.call(this,t)})}function fn(e){var t={game_id:_t};rn("goosteroids/end_game.json",t,e)}function ln(e,t){var n={game_id:_t,name:e};rn("goosteroids/set_player_name.json",n,t)}function cn(e){rn("goosteroids/get_high_scores.json",{},e)}function hn(e,t,n,r){var i=Xn(t,a,c,p,e,!0);for(var s=0;s<i.length;s++)i[s].velocity=Pr(n,r);return i}function pn(e){for(var t=0;t<e.length;t++){var n=hn(e[t].size,new Dr(Cr(0,$("#canvas").width()-1),Cr(0,$("#canvas").height()-1)),Cr(0,i),e[t].speed);for(var r=0;r<n.length;r++)ht.push(n[r])}}function dn(e,t,n,r){this.position=e,this.velocity=Pr(t,n),this.lifetime=r,this.age=0,this.lifetime=r}function vn(e){var n=ut.width-1,r=ut.height-1;for(var i=0;i<e.length;i++){var s=e[i];s.age++,s.lifetime>0&&s.age>s.lifetime?e.splice(i,1):(s.position=s.position.add(s.velocity.scale(t)),s.position.x>n&&(s.position.x=0),s.position.x<0&&(s.position.x=n),s.position.y>r&&(s.position.y=0),s.position.y<0&&(s.position.y=r));for(var o=0;o<ht.length;o++){var u=ht[o];if(Hr(s.position,u.position)<u.radius+x+g/2){yr("pop"),kt++,e.splice(i,1),ht.splice(o,1),dt.push(new Vn(u.position,a,C,L,w)),Nt+=10;for(var c=0;c<ht.length;c++){var h=ht[c];if(o!=c&&Hr(u.position,h.position)<h.radius+u.radius+f){var p=h.position.sub(u.position).normalize(),d=p.scale(l);h.addImpulse(d)}}}}}}function mn(e,t){for(var n=0;n<t.length;n++)kr(e,t[n].position,x,T)}function gn(e,t,n,r,i){$("#dialogTitle").text(e),$("#dialogMessage").html(t),r?($("#dialogInput").show(),$("#dialogInput").val("")):$("#dialogInput").hide(),$("#dialogFooter").html("");for(var s=0;s<n.length;s++){var o="";n.length==2&&s==0?o="<div class='dialog-button' style='text-align:right;'>":n.length==2&&s==1?o="<div class='dialog-button' style='text-align:left;'>":o="<div class='dialog-button'>",o+="<button class='dialog-button'>"+n[s].label+"</button></div>",$("#dialogFooter").append(o),n[s].click&&$("button.dialog-button").eq(s).click(n[s].click)}$("button.dialog-button").hover(function(){$(this).stop().animate({backgroundColor:"#0000ff"},"slow")},function(){$(this).stop().animate({backgroundColor:"#e95258"},"slow")}),i?$("#dialog").modal({onClose:i}):$("#dialog").modal()}function yn(e){var t={label:"Close",click:function(){$.modal.close(),window.location="/"}};gn("ERROR!",e,[t],!1)}function bn(e){var t="Congratulations you got a high score!<br>Brag about it by entering your name below:<br><br>",n={label:"Submit",click:function(){var t=$("#dialogInput").val();!t||t.trim().length==0?$("#dialogMessage").html("Bragging requires a name!<br>Please enter your name below:<br><br>"):($.modal.close(),xt=t,ln(t,function(){e&&e()}))}},r={label:"Cancel",click:function(){$.modal.close(),e&&e()}};gn("HIGH SCORE!",t,[n,r],!0)}function wn(){var e="Please enter your name below to tweet your score:<br><br>",t={label:"Submit",click:function(){var e=$("#dialogInput").val();if(!e||e.trim().length==0)$("#dialogMessage").html("Names contain characters silly!<br>Please enter your name below to tweet your score:<br><br>");else{var t=e+" got a score of "+Nt+" playing";xr(t,"Goosteroids"),$.modal.close(),ln(e)}}},n={label:"Cancel",click:function(){$.modal.close()}};gn("ENTER PLAYER NAME",e,[t,n],!0)}function En(e){var t="<b>Programming:</b> James McLean<br><b>Design:</b> Liam Mooney, Tom Jansen, Taulant Sulko<br><b>Music:</b> Placeholder<br><b>Sound effects:</b> Mike Koenig",n={label:"Close",click:function(){$.modal.close()}};gn("CREDITS",t,[n],!1,e)}function Sn(e,t,n){var r=new Dr(e.width-100,50);t.save(),t.font="bold 24px Arial",t.fillStyle="white",t.fillText(n,r.x,r.y),t.restore()}function xn(e,t,n){t.save(),t.font="bold 10px Arial",t.fillStyle="white",t.fillText("STAGE",20,55),t.fillText(n,60,55),t.restore()}function Tn(e,t,n){t.save(),t.font="bold 10px Arial",t.fillStyle="white",t.fillText("LIVES",20,75),t.fillText(n,60,75),t.restore()}function Nn(e,t,n){var r=new Dr(20,34);t.save(),t.font="bold 10px Arial",t.fillStyle="white",t.fillText("TURBO",r.x,r.y),t.beginPath(),t.rect(r.x+43,r.y-9,102,10),t.fillStyle="white",t.fill(),t.lineWidth=2,t.strokeStyle="white",t.stroke(),t.beginPath(),t.rect(r.x+44,r.y-8,n/K*100,8),t.fillStyle="blue",t.fill(),t.restore()}function Cn(e,t,n){var r=new Dr(e.width/2,e.height/2);t.save(),t.font="bold 18px Arial",t.fillStyle="white",t.textAlign="center",t.fillText("RESPAWNING IN "+n,r.x,r.y),t.restore()}function Ln(){kn=!0}function An(){kn=!1}function On(e,t){this.key=e,this.action=t}function Mn(e){vt.push(e)}function _n(e){mt.push(e)}function Dn(e){if(kn)for(var t=0;t<vt.length;t++){var n=vt[t];n.key==e.which&&(n.action(),e.preventDefault())}}function Pn(e){if(kn)for(var t=0;t<mt.length;t++){var n=mt[t];n.key==e.which&&(n.action(),e.preventDefault())}}function Hn(){ct.accelerating=1}function Bn(){ct.accelerating=0}function jn(){ct.turning=-1}function Fn(){ct.turning=0}function In(){ct.turning=1}function qn(){ct.turning=0}function Rn(){ct.gunFiring=!0}function Un(){ct.gunFiring=!1}function zn(){ct.abActivated=!0}function Wn(){ct.abActivated=!1,ct.abCooldown=Q}function Xn(e,n,r,s,o,u){var a=[];for(var f=0;f<o;f++){var l=new Pr(Math.random()*i,Math.random()*n),c=new Yn(r,s,e.add(l.scale(t)),l);a.push(c)}return a}function Vn(e,t,n,r,i){this.position=e,this.particles=Xn(e,t,1,k,n,!1),this.age=0,this.lifetime=r,this.color=i}function $n(e){for(var t=0;t<e.length;t++){var n=e[t];n.age++,n.lifetime>0&&n.age>n.lifetime?(n.particles=[],e.splice(t,1)):er(n.particles,a,N,!1)}}function Jn(e,t){for(var n=0;n<t.length;n++)tr(e,t[n].particles,t[n].color)}function Kn(e,t,n,r){var i=Hr(e.position,t.position);if(i<e.radius+t.radius)return new Dr(0,0);var s=n*e.mass*t.mass*Math.exp(-r*i),o=t.position.sub(e.position).normalize();return o.scale(s)}function Qn(e){for(var t=0;t<e.length;t++)for(var n=0;n<e.length;n++)t!=n&&e[t].addForce(Kn(e[t],e[n],s,o))}function Gn(e,t,n){t.clearRect(0,0,at.width,at.height);for(var r=0;r<n.length;r++){particle=n[r],t.beginPath();var s=t.createRadialGradient(particle.position.x,particle.position.y,particle.radius,particle.position.x,particle.position.y,g);s.addColorStop(0,y),s.addColorStop(1,b),t.fillStyle=s,t.arc(particle.position.x,particle.position.y,particle.radius+g,0,i),t.fill()}var o=t.getImageData(0,0,at.width,at.height),u=o.data;for(var r=0;r<u.length;r+=4){var a=r+3;u[a]<m?u[a]=0:m<=u[a]&&u[a]<=v?u[a]=255:u[a]>v&&(u[a]=255)}e.putImageData(o,0,0)}function Yn(e,t,n,r){this.radius=t,this.mass=e,this.position=n,this.velocity=r,this.acceleration=new Dr(0,0),this.forces=[]}function Zn(e,t){this.particle1=e,this.particle2=t,this.contactNormal=t.position.sub(e.position).normalize(),this.interpenetrationDepth=e.radius+t.radius-Hr(e.position,t.position)}function er(e,r,i,s){var o=ut.width-1,u=ut.height-1,a=[];for(var f=0;f<e.length;f++){var l=e[f];l.applyForces(),l.clearForces(),l.velocity=l.velocity.scale(Math.pow(i,t)).add(l.acceleration.scale(t)),l.velocity=l.velocity.normalize().scale(Nr(l.velocity.norm(),0,r)),l.position=l.position.add(l.velocity.scale(t)).add(l.acceleration.scale(n)),l.position.x>o&&(l.position.x=0),l.position.x<0&&(l.position.x=o),l.position.y>u&&(l.position.y=0),l.position.y<0&&(l.position.y=u);if(s)for(var c=f+1;c<e.length;c++){var h=e[c];Hr(l.position,h.position)<l.radius+h.radius&&a.push(new Zn(l,h))}}if(s)for(var c=0;c<a.length;c++)a[c].resolveInterpenetration(),a[c].resolveVelocity()}function tr(e,t,n){for(var r=0;r<t.length;r++)kr(e,t[r].position,t[r].radius,n)}function nr(e,t){var n=$(e),r=t*n.width()/100;n.find("div").animate({width:r},500)}function rr(e,t,n,r,i){this.alive=!0,this.gunFiring=!1,this.gunCooldown=0,this.abActivated=!1,this.abCooldown=0,this.abFuel=K,this.position=e,this.orientation=0,this.velocity=new Dr(0,0),this.maxSpeed=t,this.damping=n,this.acceleration=r,this.turnRate=i,this.turning=0,this.accelerating=0}function ir(e,i){if(e.alive){var s=ut.width-1,o=ut.height-1,u=Pr(e.orientation,1).scale(e.accelerating*e.acceleration);e.velocity=e.velocity.scale(Math.pow(e.damping,t)).add(u.scale(t)),e.velocity=e.velocity.normalize().scale(Nr(e.velocity.norm(),0,e.maxSpeed)),e.position=e.position.add(e.velocity.scale(t)).add(u.scale(n)),e.orientation+=e.turning*e.turnRate*t,e.position.x>s&&(e.position.x=0),e.position.x<0&&(e.position.x=s),e.position.y>o&&(e.position.y=0),e.position.y<0&&(e.position.y=o);for(var a=0;a<ht.length;a++){var f=ht[a],l=f.position.sub(e.position);l=Pr(l.angle()-e.orientation+r/2,l.norm());if(hr(l,f.radius+.25*g,i[0],i[1],i[2])){yr("explosion"),e.alive=!1,Ct--,ot=st,dt.push(new Vn(e.position,5*A,1.5*C,L,O)),dt.push(new Vn(e.position,2*A,5*C,L,M)),dt.push(new Vn(e.position,A/3,C,L,_)),dt.push(new Vn(e.position,A/3,C/2,L,D));return}}e.gunCooldown>0&&e.gunCooldown--;if(e.gunFiring&&e.gunCooldown==0){var c=I[1];c=Pr(c.angle()+e.orientation-r/2,c.norm()+2*W),c=c.add(e.position),pt.push(new dn(c,e.orientation,E,S)),yr("laser"),e.gunCooldown=P}e.abCooldown>0&&e.abCooldown--,e.abActivated?e.abFuel>0?(e.acceleration=X,e.maxSpeed=G,e.abFuel-=V,e.abFuel=Nr(e.abFuel,0,K)):e.abFuel==0&&(e.acceleration=B,e.maxSpeed=H):(e.acceleration=B,e.maxSpeed=H,e.abCooldown==0&&e.abFuel<K&&(e.abFuel+=J,e.abFuel=Nr(e.abFuel,0,K)))}}function sr(e,t,n,i,s,o){t.alive&&(e.save(),e.translate(t.position.x,t.position.y),e.rotate(t.orientation-r/2),Lr(e,n,i,s,o),e.restore())}function or(e,t,n,i,s,o){t.alive&&(e.save(),e.translate(t.position.x,t.position.y),e.rotate(t.orientation-r/2),Lr(e,n,i,s,o),e.restore())}function ur(e,t){var n=Math.sqrt(t*t+.25*e*e),r=Math.atan(2*t/e),i=new Dr(0,0),s=Pr(r,n),o=Pr(0,e),u=i.add(s.add(o)).scale(1/3);return i=i.sub(u),s=s.sub(u),o=o.sub(u),[i,s,o,i]}function ar(e,t,n,r){var i=t[0],s=[i];for(var o=n;o<e;o+=n)s.push(new Dr(i.x+o,i.y-Cr(0,r)-2));return s.push(t[t.length-2]),s}function fr(e,t,n,r){var i=e.sub(n).cross(r.sub(n)),s=t.sub(n).cross(r.sub(n));return i*s>=0}function lr(e,t,n,r){return fr(e,r,t,n)&&fr(e,t,n,r)&&fr(e,n,r,t)}function cr(e,t,n){var r=e.sub(t).dot(n.sub(t))/n.sub(t).dot(n.sub(t)),i=t.add(n.sub(t).scale(r));return{t:r,op:i}}function hr(e,t,n,r,i){if(lr(e,n,r,i))return!0;if(Hr(e,n)<t||Hr(e,r)<t||Hr(e,i)<t)return!0;var s=cr(e,n,r);return 0<s.t&&s.t<1&&Hr(e,s.op)<t?!0:(s=cr(e,r,i),0<s.t&&s.t<1&&Hr(e,s.op)<t?!0:(s=cr(e,i,n),0<s.t&&s.t<1&&Hr(e,s.op)<t?!0:!1))}function mr(e){var t=new createjs.LoadQueue;t.installPlugin(createjs.Sound),t.addEventListener("complete",e),t.addEventListener("progress",function(e){nr("#progressBar",e.progress*100)});var n=createjs.Sound.getCapabilities();n.mp3?t.loadManifest(dr):n.ogg?t.loadManifest(vr):Dt=!1}function gr(e){if(Dt){if(!createjs.Sound.isReady()){createjs.Sound.registerPlugins([createjs.WebAudioPlugin,createjs.HTMLAudioPlugin]),setTimeout(function(){gr(e)},1e3);return}mr(function(){Pt=!0})}e&&e.call(this)}function yr(e,t,n,r){if(Dt){t=t==undefined?1:t;var i=null;n?i=createjs.Sound.play(e,createjs.Sound.INTERRUPT_NONE,0,0,-1,t,0):i=createjs.Sound.play(e,createjs.Sound.INTERRUPT_NONE,0,0,0,t,0),r&&i.addEventListener("complete",r)}}function br(){Dt&&createjs.Sound.stop()}function wr(){jt=!0,createjs.Sound.setMute(!0)}function Er(){jt=!1,createjs.Sound.setMute(!1)}function Sr(){if(Dt){var e=_r(1,3);CURRENT_TRACK=yr("music"+e,Sr)}}function xr(e,t){var n="https://twitter.com/intent/tweet?hashtags="+t+"%2C&text="+encodeURIComponent(e)+"&tw_p=tweetbutton";window.open(n)}function Tr(){if(!xt||xt.length==0)wn();else{var e=xt+" got a score of "+Nt+" playing";xr(e,"Goosteroids")}}function Nr(e,t,n){return e<t?t:e>n?n:e}function Cr(e,t){return e+Math.random()*(t-e)}function kr(e,t,n,r){e.beginPath(),e.fillStyle=r,e.arc(t.x,t.y,n,0,i),e.closePath(),e.fill()}function Lr(e,t,n,r,i){e.beginPath(),e.moveTo(t[0].x,t[0].y);for(var s=1;s<t.length;s++)e.lineTo(t[s].x,t[s].y);n&&(e.fillStyle=n,e.fill()),r&&(e.lineWidth=i,e.strokeStyle=r,e.stroke())}function Ar(e,t,n){return e.replace(new RegExp(t+"$"),n)}function Or(e){return JSON.stringify(e,null," ")}function Mr(e){return Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds())}function _r(e,t){return Math.floor(Math.random()*(t-e+1))+e}function Dr(e,t){this.x=e,this.y=t}function Pr(e,t){return new Dr(t*Math.cos(e),t*Math.sin(e))}function Hr(e,t){return e.sub(t).norm()}var e=30,t=1/e,n=t*t,r=Math.PI,i=2*Math.PI,s=30,o=.001,u=400,a=250,f=30,l=700,c=1,h=.8,p=5,d=1,v=200,m=150,g=p*3,y="rgba(80, 80, 80, 1)",b="rgba(80, 80, 80, 0)",w="#b0b0b0",E=650,S=20,x=2,T="#ffffff",N=.8,C=15,k=2,L=20,A=1e3,O="black",M="white",_="yellow",D="red",P=6,H=400,B=500,j=i/(e*.04),F=.5,I=[],q=15,R=25,U="#e95258",z="#ffffff",W=3,X=6*B,V=5,J=2,K=100,Q=60,G=2.25*H,Y="blue",Z=3,et="#ffffff",tt=6,nt=2,rt=17,it=3,st=3*e,ot=0,ut=null,at=null,ft=null,lt=null,ct=null,ht=[],pt=[],dt=[],vt=[],mt=[],gt=38,yt=40,bt=37,wt=39,Et=32,St=16,xt="",Tt=1,Nt=0,Ct=3,kt=0,Lt=null,At=null,Ot=5e3,Mt="<%= @session_id %>",_t=0,Dt=!0,Pt=!1,Ht=1,Bt=1,jt=!1,Ft=!0;$(document).ready(function(){gr(function(){Yt(function(){setTimeout($t,2e3)})})});var Zt=!1,kn=!1;Yn.prototype.inverseMass=function(){return 1/this.mass},Yn.prototype.applyForces=function(){var e=new Dr(0,0);for(var t=0;t<this.forces.length;t++)e=e.add(this.forces[t]);this.acceleration=e.scale(this.inverseMass())},Yn.prototype.addForce=function(e){this.forces.push(e)},Yn.prototype.clearForces=function(){this.forces=[]},Yn.prototype.addImpulse=function(e){this.velocity=this.velocity.add(e.scale(this.inverseMass()))},Zn.prototype.resolveInterpenetration=function(){var e=this.particle1.inverseMass()+this.particle2.inverseMass();this.particle1.position=this.particle1.position.add(this.contactNormal.scale(-1*this.particle1.mass*e*this.interpenetrationDepth)),this.particle2.position=this.particle2.position.add(this.contactNormal.scale(this.particle2.mass*e*this.interpenetrationDepth))},Zn.prototype.resolveVelocity=function(){var e=this.particle2.velocity.sub(this.particle1.velocity),t=e.dot(this.contactNormal);if(t>0)return;var n=-1*h*t,r=n-t,i=this.particle1.inverseMass()+this.particle2.inverseMass(),s=r/i,o=this.contactNormal.scale(s);this.particle1.addImpulse(o.scale(-1)),this.particle2.addImpulse(o)};var pr=!1,dr=[{id:"laser",src:"sounds/mp3/laser.mp3"},{id:"pop",src:"sounds/mp3/pop.mp3"},{id:"explosion",src:"sounds/mp3/explosion.mp3"},{id:"music1",src:"sounds/mp3/music1.mp3"},{id:"music2",src:"sounds/mp3/music2.mp3"},{id:"music3",src:"sounds/mp3/music3.mp3"}],vr=[{id:"laser",src:"sounds/ogg/laser.ogg"},{id:"pop",src:"sounds/ogg/pop.ogg"},{id:"explosion",src:"sounds/ogg/explosion.ogg"},{id:"music1",src:"sounds/ogg/music1.ogg"},{id:"music2",src:"sounds/ogg/music2.ogg"},{id:"music3",src:"sounds/ogg/music3.ogg"}];Dr.prototype.add=function(e){return new Dr(this.x+e.x,this.y+e.y)},Dr.prototype.sub=function(e){return new Dr(this.x-e.x,this.y-e.y)},Dr.prototype.scale=function(e){return new Dr(e*this.x,e*this.y)},Dr.prototype.dot=function(e){return this.x*e.x+this.y*e.y},Dr.prototype.cross=function(e){return this.x*e.y-this.y*e.x},Dr.prototype.angle=function(){return Math.atan(this.y,this.x)},Dr.prototype.norm=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},Dr.prototype.normalize=function(){var e=this.norm();return e==0?this:this.scale(1/e)},Dr.prototype.toString=function(){return"Vector("+this.x+", "+this.y+")"};